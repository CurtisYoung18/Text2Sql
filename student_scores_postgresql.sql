-- 创建学生成绩信息表 (PostgreSQL版本)
CREATE TABLE IF NOT EXISTS student_scores (
    id SERIAL PRIMARY KEY,
    student_id VARCHAR(20) NOT NULL,
    student_name VARCHAR(50) NOT NULL,
    class_name VARCHAR(30) NOT NULL,
    subject VARCHAR(30) NOT NULL,
    score DECIMAL(5,2) NOT NULL,
    exam_date DATE NOT NULL,
    semester VARCHAR(20) NOT NULL,
    grade VARCHAR(20) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 添加注释
COMMENT ON TABLE student_scores IS '学生成绩信息表';
COMMENT ON COLUMN student_scores.student_id IS '学号';
COMMENT ON COLUMN student_scores.student_name IS '学生姓名';
COMMENT ON COLUMN student_scores.class_name IS '班级';
COMMENT ON COLUMN student_scores.subject IS '科目';
COMMENT ON COLUMN student_scores.score IS '分数';
COMMENT ON COLUMN student_scores.exam_date IS '考试日期';
COMMENT ON COLUMN student_scores.semester IS '学期';
COMMENT ON COLUMN student_scores.grade IS '年级';
COMMENT ON COLUMN student_scores.created_at IS '记录创建时间';
COMMENT ON COLUMN student_scores.updated_at IS '记录更新时间';

-- 创建索引
CREATE INDEX idx_student_id ON student_scores(student_id);
CREATE INDEX idx_subject ON student_scores(subject);
CREATE INDEX idx_semester ON student_scores(semester);
CREATE INDEX idx_exam_date ON student_scores(exam_date);
CREATE INDEX idx_class_name ON student_scores(class_name);

-- 插入测试数据
INSERT INTO student_scores (student_id, student_name, class_name, subject, score, exam_date, semester, grade) VALUES
-- 2024年春季学期数据
('2024001', '张三', '高一(1)班', '数学', 85.5, '2024-03-15', '2024春季', '高一'),
('2024001', '张三', '高一(1)班', '语文', 78.0, '2024-03-15', '2024春季', '高一'),
('2024001', '张三', '高一(1)班', '英语', 92.5, '2024-03-15', '2024春季', '高一'),
('2024001', '张三', '高一(1)班', '物理', 88.0, '2024-03-15', '2024春季', '高一'),
('2024001', '张三', '高一(1)班', '化学', 76.5, '2024-03-15', '2024春季', '高一'),

('2024002', '李四', '高一(1)班', '数学', 92.0, '2024-03-15', '2024春季', '高一'),
('2024002', '李四', '高一(1)班', '语文', 85.5, '2024-03-15', '2024春季', '高一'),
('2024002', '李四', '高一(1)班', '英语', 89.0, '2024-03-15', '2024春季', '高一'),
('2024002', '李四', '高一(1)班', '物理', 95.5, '2024-03-15', '2024春季', '高一'),
('2024002', '李四', '高一(1)班', '化学', 82.0, '2024-03-15', '2024春季', '高一'),

('2024003', '王五', '高一(2)班', '数学', 78.5, '2024-03-15', '2024春季', '高一'),
('2024003', '王五', '高一(2)班', '语文', 82.0, '2024-03-15', '2024春季', '高一'),
('2024003', '王五', '高一(2)班', '英语', 75.5, '2024-03-15', '2024春季', '高一'),
('2024003', '王五', '高一(2)班', '物理', 68.0, '2024-03-15', '2024春季', '高一'),
('2024003', '王五', '高一(2)班', '化学', 72.5, '2024-03-15', '2024春季', '高一'),

('2024004', '赵六', '高一(2)班', '数学', 95.0, '2024-03-15', '2024春季', '高一'),
('2024004', '赵六', '高一(2)班', '语文', 88.5, '2024-03-15', '2024春季', '高一'),
('2024004', '赵六', '高一(2)班', '英语', 96.0, '2024-03-15', '2024春季', '高一'),
('2024004', '赵六', '高一(2)班', '物理', 91.5, '2024-03-15', '2024春季', '高一'),
('2024004', '赵六', '高一(2)班', '化学', 89.0, '2024-03-15', '2024春季', '高一'),

('2024005', '钱七', '高一(3)班', '数学', 65.5, '2024-03-15', '2024春季', '高一'),
('2024005', '钱七', '高一(3)班', '语文', 72.0, '2024-03-15', '2024春季', '高一'),
('2024005', '钱七', '高一(3)班', '英语', 68.5, '2024-03-15', '2024春季', '高一'),
('2024005', '钱七', '高一(3)班', '物理', 55.0, '2024-03-15', '2024春季', '高一'),
('2024005', '钱七', '高一(3)班', '化学', 62.5, '2024-03-15', '2024春季', '高一'),

('2024006', '孙八', '高一(3)班', '数学', 88.0, '2024-03-15', '2024春季', '高一'),
('2024006', '孙八', '高一(3)班', '语文', 85.5, '2024-03-15', '2024春季', '高一'),
('2024006', '孙八', '高一(3)班', '英语', 82.0, '2024-03-15', '2024春季', '高一'),
('2024006', '孙八', '高一(3)班', '物理', 79.5, '2024-03-15', '2024春季', '高一'),
('2024006', '孙八', '高一(3)班', '化学', 84.0, '2024-03-15', '2024春季', '高一'),

-- 高二年级数据
('2023001', '周九', '高二(1)班', '数学', 91.5, '2024-03-15', '2024春季', '高二'),
('2023001', '周九', '高二(1)班', '语文', 87.0, '2024-03-15', '2024春季', '高二'),
('2023001', '周九', '高二(1)班', '英语', 93.5, '2024-03-15', '2024春季', '高二'),
('2023001', '周九', '高二(1)班', '物理', 89.0, '2024-03-15', '2024春季', '高二'),
('2023001', '周九', '高二(1)班', '化学', 86.5, '2024-03-15', '2024春季', '高二'),

('2023002', '吴十', '高二(1)班', '数学', 76.0, '2024-03-15', '2024春季', '高二'),
('2023002', '吴十', '高二(1)班', '语文', 79.5, '2024-03-15', '2024春季', '高二'),
('2023002', '吴十', '高二(1)班', '英语', 82.0, '2024-03-15', '2024春季', '高二'),
('2023002', '吴十', '高二(1)班', '物理', 71.5, '2024-03-15', '2024春季', '高二'),
('2023002', '吴十', '高二(1)班', '化学', 78.0, '2024-03-15', '2024春季', '高二'),

('2023003', '郑十一', '高二(2)班', '数学', 94.5, '2024-03-15', '2024春季', '高二'),
('2023003', '郑十一', '高二(2)班', '语文', 91.0, '2024-03-15', '2024春季', '高二'),
('2023003', '郑十一', '高二(2)班', '英语', 97.5, '2024-03-15', '2024春季', '高二'),
('2023003', '郑十一', '高二(2)班', '物理', 93.0, '2024-03-15', '2024春季', '高二'),
('2023003', '郑十一', '高二(2)班', '化学', 90.5, '2024-03-15', '2024春季', '高二'),

('2023004', '王十二', '高二(2)班', '数学', 82.5, '2024-03-15', '2024春季', '高二'),
('2023004', '王十二', '高二(2)班', '语文', 85.0, '2024-03-15', '2024春季', '高二'),
('2023004', '王十二', '高二(2)班', '英语', 88.5, '2024-03-15', '2024春季', '高二'),
('2023004', '王十二', '高二(2)班', '物理', 80.0, '2024-03-15', '2024春季', '高二'),
('2023004', '王十二', '高二(2)班', '化学', 83.5, '2024-03-15', '2024春季', '高二'),

-- 高三年级数据
('2022001', '李十三', '高三(1)班', '数学', 89.0, '2024-03-15', '2024春季', '高三'),
('2022001', '李十三', '高三(1)班', '语文', 92.5, '2024-03-15', '2024春季', '高三'),
('2022001', '李十三', '高三(1)班', '英语', 95.0, '2024-03-15', '2024春季', '高三'),
('2022001', '李十三', '高三(1)班', '物理', 87.5, '2024-03-15', '2024春季', '高三'),
('2022001', '李十三', '高三(1)班', '化学', 90.0, '2024-03-15', '2024春季', '高三'),

('2022002', '张十四', '高三(1)班', '数学', 96.5, '2024-03-15', '2024春季', '高三'),
('2022002', '张十四', '高三(1)班', '语文', 94.0, '2024-03-15', '2024春季', '高三'),
('2022002', '张十四', '高三(1)班', '英语', 98.5, '2024-03-15', '2024春季', '高三'),
('2022002', '张十四', '高三(1)班', '物理', 92.0, '2024-03-15', '2024春季', '高三'),
('2022002', '张十四', '高三(1)班', '化学', 95.5, '2024-03-15', '2024春季', '高三'),

('2022003', '刘十五', '高三(2)班', '数学', 73.5, '2024-03-15', '2024春季', '高三'),
('2022003', '刘十五', '高三(2)班', '语文', 76.0, '2024-03-15', '2024春季', '高三'),
('2022003', '刘十五', '高三(2)班', '英语', 79.5, '2024-03-15', '2024春季', '高三'),
('2022003', '刘十五', '高三(2)班', '物理', 68.0, '2024-03-15', '2024春季', '高三'),
('2022003', '刘十五', '高三(2)班', '化学', 71.5, '2024-03-15', '2024春季', '高三'),

('2022004', '陈十六', '高三(2)班', '数学', 85.0, '2024-03-15', '2024春季', '高三'),
('2022004', '陈十六', '高三(2)班', '语文', 88.5, '2024-03-15', '2024春季', '高三'),
('2022004', '陈十六', '高三(2)班', '英语', 91.0, '2024-03-15', '2024春季', '高三'),
('2022004', '陈十六', '高三(2)班', '物理', 83.5, '2024-03-15', '2024春季', '高三'),
('2022004', '陈十六', '高三(2)班', '化学', 86.0, '2024-03-15', '2024春季', '高三'),

-- 2023年秋季学期数据（用于对比）
('2024001', '张三', '高一(1)班', '数学', 82.0, '2023-12-20', '2023秋季', '高一'),
('2024001', '张三', '高一(1)班', '语文', 75.5, '2023-12-20', '2023秋季', '高一'),
('2024001', '张三', '高一(1)班', '英语', 88.0, '2023-12-20', '2023秋季', '高一'),
('2024001', '张三', '高一(1)班', '物理', 85.5, '2023-12-20', '2023秋季', '高一'),
('2024001', '张三', '高一(1)班', '化学', 70.0, '2023-12-20', '2023秋季', '高一'),

('2024002', '李四', '高一(1)班', '数学', 89.5, '2023-12-20', '2023秋季', '高一'),
('2024002', '李四', '高一(1)班', '语文', 82.0, '2023-12-20', '2023秋季', '高一'),
('2024002', '李四', '高一(1)班', '英语', 85.5, '2023-12-20', '2023秋季', '高一'),
('2024002', '李四', '高一(1)班', '物理', 92.0, '2023-12-20', '2023秋季', '高一'),
('2024002', '李四', '高一(1)班', '化学', 78.5, '2023-12-20', '2023秋季', '高一'),

('2023001', '周九', '高二(1)班', '数学', 88.0, '2023-12-20', '2023秋季', '高二'),
('2023001', '周九', '高二(1)班', '语文', 84.5, '2023-12-20', '2023秋季', '高二'),
('2023001', '周九', '高二(1)班', '英语', 90.0, '2023-12-20', '2023秋季', '高二'),
('2023001', '周九', '高二(1)班', '物理', 86.5, '2023-12-20', '2023秋季', '高二'),
('2023001', '周九', '高二(1)班', '化学', 82.0, '2023-12-20', '2023秋季', '高二'),

('2022001', '李十三', '高三(1)班', '数学', 85.5, '2023-12-20', '2023秋季', '高三'),
('2022001', '李十三', '高三(1)班', '语文', 89.0, '2023-12-20', '2023秋季', '高三'),
('2022001', '李十三', '高三(1)班', '英语', 92.5, '2023-12-20', '2023秋季', '高三'),
('2022001', '李十三', '高三(1)班', '物理', 84.0, '2023-12-20', '2023秋季', '高三'),
('2022001', '李十三', '高三(1)班', '化学', 87.5, '2023-12-20', '2023秋季', '高三');

-- 创建一些额外的测试数据用于复杂查询测试
INSERT INTO student_scores (student_id, student_name, class_name, subject, score, exam_date, semester, grade) VALUES
-- 添加更多学生数据
('2024007', '冯十七', '高一(1)班', '数学', 95.5, '2024-03-15', '2024春季', '高一'),
('2024007', '冯十七', '高一(1)班', '语文', 91.0, '2024-03-15', '2024春季', '高一'),
('2024007', '冯十七', '高一(1)班', '英语', 94.5, '2024-03-15', '2024春季', '高一'),
('2024007', '冯十七', '高一(1)班', '物理', 93.0, '2024-03-15', '2024春季', '高一'),
('2024007', '冯十七', '高一(1)班', '化学', 90.5, '2024-03-15', '2024春季', '高一'),

('2024008', '朱十八', '高一(2)班', '数学', 55.0, '2024-03-15', '2024春季', '高一'),
('2024008', '朱十八', '高一(2)班', '语文', 58.5, '2024-03-15', '2024春季', '高一'),
('2024008', '朱十八', '高一(2)班', '英语', 52.0, '2024-03-15', '2024春季', '高一'),
('2024008', '朱十八', '高一(2)班', '物理', 48.5, '2024-03-15', '2024春季', '高一'),
('2024008', '朱十八', '高一(2)班', '化学', 54.0, '2024-03-15', '2024春季', '高一'),

('2023005', '何十九', '高二(3)班', '数学', 87.5, '2024-03-15', '2024春季', '高二'),
('2023005', '何十九', '高二(3)班', '语文', 84.0, '2024-03-15', '2024春季', '高二'),
('2023005', '何十九', '高二(3)班', '英语', 89.5, '2024-03-15', '2024春季', '高二'),
('2023005', '何十九', '高二(3)班', '物理', 86.0, '2024-03-15', '2024春季', '高二'),
('2023005', '何十九', '高二(3)班', '化学', 88.5, '2024-03-15', '2024春季', '高二'),

('2022005', '高二十', '高三(3)班', '数学', 99.0, '2024-03-15', '2024春季', '高三'),
('2022005', '高二十', '高三(3)班', '语文', 97.5, '2024-03-15', '2024春季', '高三'),
('2022005', '高二十', '高三(3)班', '英语', 99.5, '2024-03-15', '2024春季', '高三'),
('2022005', '高二十', '高三(3)班', '物理', 98.0, '2024-03-15', '2024春季', '高三'),
('2022005', '高二十', '高三(3)班', '化学', 96.5, '2024-03-15', '2024春季', '高三');

-- 验证数据插入
SELECT 
    COUNT(*) as total_records,
    COUNT(DISTINCT student_id) as unique_students,
    COUNT(DISTINCT subject) as subjects,
    COUNT(DISTINCT semester) as semesters,
    COUNT(DISTINCT grade) as grades
FROM student_scores; 